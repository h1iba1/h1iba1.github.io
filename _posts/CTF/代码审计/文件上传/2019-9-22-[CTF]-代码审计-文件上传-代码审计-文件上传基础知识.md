1.漏洞条件

文件可上传

知道文件上传的路径

上传文件可被访问

上传文件可被执行



2.文件上传可控点

Content——Length,上传内容大小

MAX_FILE_SIZE，即上传内容的最大长度

filename，即上传文件名

Content-Type，上传文件类型

请求包中的乱码字段，既是所上传文件的内容

又可能存在请求包总的可控点还有上传路径，



3.挖掘思路

上传点都调用同一个上传类，直接全局搜索上传函数

黑盒寻找上传点，代码定位



4.文件上传绕过—服务端

4.1黑白名单过滤

4.2修改mime类型

4.3截断上传攻击

4.4.htaccess文件攻击

4.5目录验证

